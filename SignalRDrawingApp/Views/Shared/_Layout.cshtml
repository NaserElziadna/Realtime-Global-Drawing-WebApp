<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#343a40" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <title>@ViewData["Title"] - SignalRDrawingApp</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/SignalRDrawingApp.styles.css" asp-append-version="true" />
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.5/signalr.min.js"></script>
    <style>
        /* Ensure chat toggle is always visible */
        #chat-toggle {
            position: fixed !important;
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            z-index: 9999 !important;
        }
    </style>
</head>
<body>
    @RenderBody()

    @await RenderSectionAsync("Scripts", required: false)
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="~/js/canvas.js" asp-append-version="true"></script>
    <script src="~/js/chat.js" asp-append-version="true"></script>
    
    <script>
        // Ensure chat toggle is visible after page load
        document.addEventListener('DOMContentLoaded', function() {
            // Force chat toggle to be visible
            var chatToggle = document.getElementById('chat-toggle');
            if (chatToggle) {
                chatToggle.style.display = 'flex';
                chatToggle.style.visibility = 'visible';
                chatToggle.style.opacity = '1';
            }
            
            // Check visibility after a delay
            setTimeout(function() {
                var chatToggle = document.getElementById('chat-toggle');
                if (chatToggle) {
                    console.log('Chat toggle visibility check:', 
                        chatToggle.style.display, 
                        chatToggle.style.visibility, 
                        chatToggle.style.opacity);
                    
                    // Force visibility again
                    chatToggle.style.display = 'flex';
                    chatToggle.style.visibility = 'visible';
                    chatToggle.style.opacity = '1';
                }
            }, 2000);
        });
    </script>

    <script>
        // Ensure chat toggle is visible after page load
        document.addEventListener('DOMContentLoaded', function() {
            // Force chat toggle to be visible (desktop)
            var chatToggle = document.getElementById('chat-toggle');
            if (chatToggle) {
                chatToggle.style.display = 'flex';
                chatToggle.style.visibility = 'visible';
                chatToggle.style.opacity = '1';
            }
            
            // Force mobile chat toggle to be visible (mobile)
            var mobileChatToggle = document.getElementById('mobile-chat-toggle');
            if (mobileChatToggle) {
                mobileChatToggle.style.display = 'flex';
                mobileChatToggle.style.visibility = 'visible';
                mobileChatToggle.style.opacity = '1';
                console.log('Mobile chat toggle found and made visible');
            } else {
                console.log('Mobile chat toggle not found');
            }
            
            // Check visibility after a delay
            setTimeout(function() {
                var isMobile = window.innerWidth <= 768;
                var toggleToCheck = isMobile ? 
                    document.getElementById('mobile-chat-toggle') : 
                    document.getElementById('chat-toggle');
                
                if (toggleToCheck) {
                    console.log('Chat toggle visibility check (', isMobile ? 'mobile' : 'desktop', '):', 
                        toggleToCheck.style.display, 
                        toggleToCheck.style.visibility, 
                        toggleToCheck.style.opacity);
                    
                    // Force visibility again
                    toggleToCheck.style.display = 'flex';
                    toggleToCheck.style.visibility = 'visible';
                    toggleToCheck.style.opacity = '1';
                }
            }, 2000);
        });
    </script>
</body>
</html>